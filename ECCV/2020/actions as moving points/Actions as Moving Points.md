# (ECCV 2020) Actions as Moving Points

## 0. Summary

已有方法多对目标检测中的二阶段或一阶段方法进行拓展，这些方法本身存在一些问题，将其扩展至动作识别中后仍然保留了这些问题，甚至更加严重。作者通过对目标检测中针对这类问题进行解决的CenterNet进行扩展。

## 1. Research Objective

​	设计一个无需anchor设置的tubelet检测器，避免启发式anchor设置带来的次优结果，及定位不够准确等问题。

## 2. Background and Problems

+ 时空间动作检测的早期方法使用逐帧预测，再讲预测结果进行拼接的方式，该类方法没有使用时序信息，实际的性能较差。
+ Tublet检测器将切片作为输入能够使用时序信息，但已有的方法基于目标检测的Faster RCNN及SSD等方法。
  + Faster RCNN 及 SSD类方法对anchor、bbox等超参数的设置敏感，且对于目标密集的场景性能不好。
  + 将该类方法拓展至动作识别中存在一些问题：
    + video中anchor相比图像大大增加，增大了训练及测试的难度。
    + 需要设计更加复杂的anchor设置方式，来考虑时序维度的变化。
    + 已有的将anchor从2D拓展至3D的方式过于简单粗暴，将其设置为3D的立方体，没有考虑目标位置随时间的变化。
+ 目标检测中CornerNet、CenterNet等方式没有使用anchor，受这类方法启发设计一个无需anchor的方法。
+ ***Problem***：将CenterNet中使用目标中心表示目标的方式拓展至时序空间，并设计相应的学习策略。

## 3. Method

+ 首先使用**2D主干网络**对输入切片中的每一帧分别进行前向传播获得每一帧的特征。

  > 可以使用3D卷积或者注意力机制或者两者相结合的方式提取特征，这里使用2D主干网络可能是为了保证box分支的输入特征不包含时序信息。

+ 将得到的特征作为共享特征送入三个不同的分支：

  + **Center Branch**：将不同帧的特征在通道上concat后作为输入，进行关键帧上目标实例的中心点定位及行为分类。

    + 使用heatmap预测当前位置属于不同类别实例中心的可能性。
    + **训练**：将真值bbox的中心作为预测目标，仅对正确类别的heatmap设置高斯分布，其他类别的heatmap设置为全零。
    + **测试**：使用3*3 max pooling提取局部峰值，保留N个最高值作为可能的实例中心。

  + **Movement Branch**: 与center分支相同的输入，直接输出不同帧中实例中心相对于keyframe实例中心的偏移。

    + 输出大小为 W/R * H/R * (K * 2)其中 K 表示输入切片的长度，每个元素表示关键帧中以此位置为实例中心时，当前帧实例中心的偏移。

      > 设计方式与center分支相同，都是基于heatmap的表示，属于间接的学习方式。

    + **训练**：仅对关键帧中心对应的位置进行学习。

      > 需要训练集中实例中心能够覆盖输出结果的每个位置。

    + **测试**：对N个可能的实例中心都进行movement的预测。

  + **Box Branch**: 作者假设box预测仅使用当前帧信息，仅使用当前帧对应的特征。该分支的工作可以视为目标检测，无需时序信息。

    + 输出方式与其他两个防止相似，但是该分支与movement分支仅对正样本进行学习。
    
      > 时序信息对于目标实例的定位是有用的，但是目标实例bounding box的大小及长宽比，仅依靠当前帧的信息就可得出，时序信息帮助不大。

+ 对视频进行链接。

## 4. Evalution

+ 消融实验
  + 通过比较不同的movement分支设计，得出movement对提升video-mAP十分重要，但是对frame-mAP提升较小。这是由于对于单帧而言，微小的误差对frame-mAP影响较小，但是累计起来对video-mAP有较大影响。
  + Box分支对keyframe中实力中心的变化稳定，即使位置存在偏移，bbox的预测仍较为准确。
+ 对比试验
  + 与state-of-art相比能够达到相同的处理速度，25fps，但是更加准确。

## 5. Conclusion

+ 提出的MOC detector达到了state-of-art的性能，且维持了合理的计算开销。
+ 目前仅在短clip上运行，且没有判断判断时序边界的能力。

## Notes

## References

[15, 36, 38, 41]
